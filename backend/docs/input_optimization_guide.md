# è¾“å…¥ä¼˜åŒ–æŒ‡å— - è§£å†³æ–‡æœ¬è¾“å…¥è¶…æ—¶é—®é¢˜

## é—®é¢˜èƒŒæ™¯

åœ¨ä½¿ç”¨æµè§ˆå™¨è‡ªåŠ¨åŒ–æ—¶ï¼Œç»å¸¸é‡åˆ°æ–‡æœ¬è¾“å…¥è¶…æ—¶çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯ï¼š
- åœ¨æœç´¢æ¡†è¾“å…¥é•¿æ–‡æœ¬æ—¶å‡ºç°æœç´¢å»ºè®®ä¸‹æ‹‰æ¡†å¯¼è‡´çš„15ç§’è¶…æ—¶
- TypeTextEventçš„watchdogè¶…æ—¶é”™è¯¯
- ç½‘ç»œå»¶è¿Ÿæˆ–DOMä¸ç¨³å®šé€ æˆçš„è¾“å…¥ä¸­æ–­

## è§£å†³æ–¹æ¡ˆ

æˆ‘ä»¬å¼€å‘äº†å¢å¼ºç‰ˆçš„è¾“å…¥ç³»ç»Ÿï¼Œæä¾›å¤šç§è¾“å…¥ç­–ç•¥æ¥åº”å¯¹ä¸åŒåœºæ™¯ï¼š

### 1. å¢å¼ºé»˜è®¤ç­–ç•¥ (`enhanced`)

**é€‚ç”¨åœºæ™¯ï¼š** å¤§å¤šæ•°æœç´¢æ¡†å’Œè¡¨å•è¾“å…¥

**ç‰¹ç‚¹ï¼š**
- å¿«é€Ÿä¸€æ¬¡æ€§è¾“å…¥å®Œæ•´æ–‡æœ¬
- è‡ªåŠ¨å¤„ç†æœç´¢å»ºè®®ä¸‹æ‹‰æ¡†å¹²æ‰°
- ä¼˜åŒ–çš„è¶…æ—¶è®¾ç½® (30ç§’åŠ¨ä½œè¶…æ—¶ï¼Œ25ç§’watchdogè¶…æ—¶)
- è¾“å…¥å®Œæˆåè‡ªåŠ¨æŒ‰ESCé”®å…³é—­ä¸‹æ‹‰æ¡†

### 2. åˆ†æ®µè¾“å…¥ç­–ç•¥ (`chunked`)

**é€‚ç”¨åœºæ™¯ï¼š** è¶…é•¿æ–‡æœ¬è¾“å…¥ï¼Œç½‘ç»œå»¶è¿Ÿè¾ƒé«˜çš„ç¯å¢ƒ

**ç‰¹ç‚¹ï¼š**
- å°†é•¿æ–‡æœ¬åˆ†å‰²æˆå°æ®µ(é»˜è®¤10ä¸ªå­—ç¬¦)é€æ­¥è¾“å…¥
- æ¯æ®µä¹‹é—´æœ‰çŸ­æš‚å»¶è¿Ÿé¿å…è§¦å‘è¶…æ—¶
- é€‚åˆå¤„ç†å¤æ‚è¡¨å•å’Œè¶…é•¿æŸ¥è¯¢

### 3. ç²˜è´´ç­–ç•¥ (`paste`)

**é€‚ç”¨åœºæ™¯ï¼š** ä»£ç è¾“å…¥ï¼Œæ ¼å¼åŒ–æ–‡æœ¬ï¼Œå¤šè¡Œæ–‡æœ¬

**ç‰¹ç‚¹ï¼š**
- ä½¿ç”¨å‰ªè´´æ¿ç²˜è´´æ•´ä¸ªæ–‡æœ¬
- æœ€å¿«çš„è¾“å…¥æ–¹å¼
- é¿å…é€å­—ç¬¦è¾“å…¥çš„æ‰€æœ‰é—®é¢˜

## ä½¿ç”¨æ–¹æ³•

### APIæ¥å£

#### 1. è·å–å½“å‰è¾“å…¥é…ç½®
```http
GET /api/input/config
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "success": true,
  "data": {
    "use_enhanced_input": true,
    "input_strategy": "enhanced",
    "available_strategies": ["enhanced", "chunked", "paste"],
    "strategy_descriptions": {
      "enhanced": "å¢å¼ºé»˜è®¤ç­–ç•¥ï¼Œå¿«é€Ÿè¾“å…¥å¹¶å¤„ç†æœç´¢å»ºè®®å¹²æ‰°",
      "chunked": "åˆ†æ®µè¾“å…¥ç­–ç•¥ï¼Œå°†é•¿æ–‡æœ¬åˆ†å‰²æˆå°æ®µè¾“å…¥",
      "paste": "ç²˜è´´ç­–ç•¥ï¼Œä½¿ç”¨å‰ªè´´æ¿ç²˜è´´æ•´ä¸ªæ–‡æœ¬"
    }
  }
}
```

#### 2. è®¾ç½®è¾“å…¥ç­–ç•¥
```http
POST /api/input/strategy
Content-Type: application/json

{
  "strategy": "enhanced"
}
```

#### 3. åˆ‡æ¢å¢å¼ºè¾“å…¥åŠŸèƒ½
```http
POST /api/input/toggle-enhanced
Content-Type: application/json

{
  "enabled": true
}
```

#### 4. è·å–æ‰€æœ‰å¯ç”¨ç­–ç•¥
```http
GET /api/input/strategies
```

#### 5. æµ‹è¯•è¾“å…¥ç­–ç•¥
```http
POST /api/input/test-strategy?strategy=enhanced
```

### ä»£ç ä½¿ç”¨ç¤ºä¾‹

```python
from Agent.unified_agent import E2BUnifiedAgent

# åˆ›å»ºå¯ç”¨å¢å¼ºè¾“å…¥çš„Agent
agent = E2BUnifiedAgent(
    use_enhanced_input=True,
    input_strategy="enhanced"
)

# åŠ¨æ€åˆ‡æ¢è¾“å…¥ç­–ç•¥
agent.set_input_strategy("chunked")

# æ‰§è¡Œä»»åŠ¡æ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨é…ç½®çš„è¾“å…¥ç­–ç•¥
result = await agent.execute_task("åœ¨Googleæœç´¢æ¡†ä¸­è¾“å…¥ 'artificial intelligence machine learning deep learning neural networks'")
```

## ç­–ç•¥é€‰æ‹©å»ºè®®

### ğŸ¯ æ¨èä½¿ç”¨åœºæ™¯

| è¾“å…¥å†…å®¹ | æ¨èç­–ç•¥ | åŸå›  |
|---------|---------|------|
| çŸ­æŸ¥è¯¢è¯(1-20å­—ç¬¦) | `enhanced` | å¿«é€Ÿè¾“å…¥ï¼Œå¤„ç†ä¸‹æ‹‰æ¡† |
| é•¿æŸ¥è¯¢å¥(20-100å­—ç¬¦) | `enhanced` | ä¸€æ¬¡æ€§è¾“å…¥ï¼Œé¿å…ä¸­æ–­ |
| è¶…é•¿æ–‡æœ¬(100+å­—ç¬¦) | `chunked` | åˆ†æ®µè¾“å…¥é¿å…è¶…æ—¶ |
| ä»£ç ç‰‡æ®µ | `paste` | ä¿æŒæ ¼å¼ï¼Œé¿å…è¯­æ³•é”™è¯¯ |
| å¤šè¡Œæ–‡æœ¬ | `paste` | å¤„ç†æ¢è¡Œç¬¦ï¼Œä¿æŒç»“æ„ |
| è¡¨å•å¡«å†™ | `enhanced` | å¿«é€Ÿå®Œæˆï¼Œå¤„ç†éªŒè¯ |

### âš ï¸ æ•…éšœæ’é™¤

å¦‚æœé‡åˆ°è¾“å…¥é—®é¢˜ï¼š

1. **è¶…æ—¶é”™è¯¯ï¼š** åˆ‡æ¢åˆ° `chunked` ç­–ç•¥
2. **ä¸‹æ‹‰æ¡†å¹²æ‰°ï¼š** ä½¿ç”¨ `enhanced` ç­–ç•¥
3. **æ ¼å¼ä¸¢å¤±ï¼š** é€‰æ‹© `paste` ç­–ç•¥
4. **ç½‘ç»œå»¶è¿Ÿï¼š** é™ä½åˆ†æ®µå¤§å°æˆ–ä½¿ç”¨ `paste`

## æŠ€æœ¯å®ç°

### å¢å¼ºé…ç½®å‚æ•°

```python
{
    'action_timeout': 30,        # åŠ¨ä½œè¶…æ—¶æ—¶é—´(ç§’)
    'watchdog_timeout': 25,      # watchdogè¶…æ—¶æ—¶é—´(ç§’)
    'input_delay': 50,           # è¾“å…¥å»¶è¿Ÿ(æ¯«ç§’)
    'wait_for_stable_dom': True, # ç­‰å¾…DOMç¨³å®š
    'disable_web_security': True # ç¦ç”¨webå®‰å…¨é™åˆ¶
}
```

### è‡ªåŠ¨ç­–ç•¥åˆ‡æ¢

ç³»ç»Ÿä¼šæ ¹æ®é”™è¯¯ç±»å‹è‡ªåŠ¨è°ƒæ•´ç­–ç•¥ï¼š
- æ£€æµ‹åˆ°è¶…æ—¶é”™è¯¯ â†’ åˆ‡æ¢åˆ°åˆ†æ®µè¾“å…¥
- åˆ†æ®µè¾“å…¥ä»å¤±è´¥ â†’ åˆ‡æ¢åˆ°ç²˜è´´ç­–ç•¥
- æä¾›è¯¦ç»†çš„é”™è¯¯åé¦ˆå’Œå»ºè®®

## ç›‘æ§å’Œè°ƒè¯•

### æ—¥å¿—è¾“å‡ºç¤ºä¾‹

```
ğŸš€ ä½¿ç”¨å¢å¼ºè¾“å…¥ç­–ç•¥: enhanced
ğŸ¯ ä½¿ç”¨å¢å¼ºè¾“å…¥ç­–ç•¥è¾“å…¥æ–‡æœ¬: artificial intelligence...
ğŸ“ ä½¿ç”¨åˆ†æ®µè¾“å…¥ç­–ç•¥ï¼Œæ–‡æœ¬é•¿åº¦: 50, åˆ†æ®µå¤§å°: 10
âœ… å¢å¼ºé»˜è®¤è¾“å…¥å®Œæˆ
```

### é”™è¯¯å¤„ç†

```json
{
  "success": false,
  "error": "Input timeout",
  "message": "æ–‡æœ¬è¾“å…¥è¶…æ—¶ã€‚å»ºè®®å°è¯•åˆ‡æ¢è¾“å…¥ç­–ç•¥ï¼šå½“å‰ä¸º enhancedï¼Œå¯å°è¯• chunked æˆ– paste ç­–ç•¥ã€‚",
  "suggestion": "try_different_input_strategy"
}
```

## æ›´æ–°æ—¥å¿—

- **v1.0.0** - åŸºç¡€å¢å¼ºè¾“å…¥ç³»ç»Ÿ
- **v1.1.0** - æ·»åŠ åˆ†æ®µå’Œç²˜è´´ç­–ç•¥
- **v1.2.0** - è‡ªåŠ¨ç­–ç•¥åˆ‡æ¢å’Œé”™è¯¯å¤„ç†
- **v1.3.0** - APIæ¥å£å’Œé…ç½®ç®¡ç†

é€šè¿‡è¿™äº›ä¼˜åŒ–ï¼Œæ‚¨ç°åœ¨å¯ä»¥å¯é åœ°è¿›è¡Œä¸€æ¬¡æ€§å®Œæ•´æ–‡æœ¬è¾“å…¥ï¼Œè€Œä¸å†å—åˆ°æœç´¢å»ºè®®ä¸‹æ‹‰æ¡†æˆ–è¶…æ—¶é—®é¢˜çš„å›°æ‰°ã€‚

